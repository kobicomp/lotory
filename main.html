<!DOCTYPE html>
<html dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>◊û◊ó◊ï◊ú◊ú ◊î◊í◊®◊ú◊ï◊™ ◊§◊®◊ô◊û◊ô◊ï◊ù</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap');

    * {
      box-sizing: border-box;
      font-family: 'Rubik', 'Segoe UI', Arial, sans-serif;
    }

    body {
      background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
      margin: 0;
      padding: 20px;
      direction: rtl;
      min-height: 100vh;
      color: #fff;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: rgba(13, 17, 23, 0.85);
      border-radius: 20px;
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
      padding: 30px;
      position: relative;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
    }

    .container:before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(rgba(255, 255, 255, 0.1) 2px, transparent 3px);
      background-size: 30px 30px;
      transform: rotate(30deg);
      z-index: 0;
      opacity: 0.2;
      pointer-events: none;
    }

    h1 {
      color: #fff;
      text-align: center;
      margin-bottom: 30px;
      font-size: 42px;
      position: relative;
      text-shadow: 0 0 10px rgba(79, 195, 247, 0.8);
      z-index: 1;
    }

    h1 span {
      background: linear-gradient(45deg, #4FC3F7, #E040FB);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: inline-block;
    }

    h1::after {
      content: '';
      display: block;
      width: 180px;
      height: 5px;
      background: linear-gradient(to right, #4FC3F7, #E040FB);
      margin: 15px auto 0;
      border-radius: 5px;
      box-shadow: 0 0 15px rgba(79, 195, 247, 0.7);
    }

    .main-content {
      position: relative;
      z-index: 1;
    }

    .lottery-box {
      position: relative;
      min-height: 400px;
      padding: 20px;
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      overflow: hidden;
      margin-bottom: 20px;
      box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.3);
      transition: all 0.5s;
    }

    .lottery-box:before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at center, rgba(79, 195, 247, 0.1) 0%, rgba(224, 64, 251, 0.05) 100%);
      opacity: 0.5;
      pointer-events: none;
      z-index: 0;
    }

    .hexagon-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      padding: 15px;
      max-height: 400px;
      overflow-y: auto;
      position: relative;
      z-index: 1;
    }

    .hexagon-container::-webkit-scrollbar {
      width: 8px;
    }

    .hexagon-container::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .hexagon-container::-webkit-scrollbar-thumb {
      background: rgba(79, 195, 247, 0.2);
      border-radius: 4px;
    }

    .hexagon-container::-webkit-scrollbar-thumb:hover {
      background: rgba(79, 195, 247, 0.3);
    }

    .hexagon {
      width: 100px;
      height: 115px;
      position: relative;
      margin: 5px;
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      background: rgba(255, 255, 255, 0.08);
      transition: all 0.5s;
      cursor: default;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
    }

    .hexagon:hover {
      transform: translateY(-5px);
      background: rgba(255, 255, 255, 0.12);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    .hexagon-index {
      position: absolute;
      top: 5px;
      left: 8px;
      font-size: 12px;
      font-weight: bold;
      color: rgba(255, 255, 255, 0.7);
    }

    .hexagon-content {
      text-align: center;
      font-size: 14px;
      word-break: break-word;
      max-height: 80%;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
    }

    .hexagon.highlight {
      animation: highlightPulse 0.3s infinite;
      background: rgba(255, 193, 7, 0.2);
      z-index: 10;
    }

    @keyframes highlightPulse {
      0% { box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
      50% { box-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
      100% { box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
    }

    .hexagon.winner {
      background: linear-gradient(135deg, #FFC107, #FF5722);
      transform: scale(1.08) translateY(-5px);
      z-index: 20;
      box-shadow: 0 15px 30px rgba(255, 87, 34, 0.4);
      animation: winnerPulse 3s infinite;
    }

    @keyframes winnerPulse {
      0% { box-shadow: 0 15px 30px rgba(255, 87, 34, 0.4); }
      50% { box-shadow: 0 15px 40px rgba(255, 193, 7, 0.7); }
      100% { box-shadow: 0 15px 30px rgba(255, 87, 34, 0.4); }
    }

    .hexagon.winner:before {
      content: 'üèÜ';
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 24px;
      z-index: 30;
      filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.5));
    }

    .btn-draw {
      background: linear-gradient(45deg, #FF6D00, #FFAB00);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      font-size: 22px;
      border-radius: 15px;
      margin: 20px auto;
      position: relative;
      overflow: hidden;
      padding: 20px 40px;
      max-width: 300px;
      cursor: pointer;
      border: none;
      color: white;
      font-weight: bold;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      box-shadow: 0 8px 20px rgba(255, 109, 0, 0.3);
      transition: all 0.3s;
    }

    .btn-draw:hover {
      background: linear-gradient(45deg, #FF5722, #FFC107);
      transform: translateY(-3px);
      box-shadow: 0 12px 25px rgba(255, 109, 0, 0.4);
    }

    .btn-draw:active {
      transform: translateY(1px);
      box-shadow: 0 5px 15px rgba(255, 109, 0, 0.4);
    }

    .btn-draw:disabled {
      background: linear-gradient(45deg, #9E9E9E, #BDBDBD);
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      opacity: 0.7;
    }

    .btn-icon {
      font-size: 28px;
      z-index: 2;
    }

    .btn-text {
      z-index: 2;
    }

    .btn-settings {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 100;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .btn-settings:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: rotate(30deg);
    }

    .settings-panel {
      position: fixed;
      top: 0;
      left: -400px;
      width: 400px;
      height: 100%;
      background: rgba(13, 17, 23, 0.95);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      transition: all 0.5s;
      padding: 30px;
      overflow-y: auto;
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
    }

    .settings-panel.open {
      left: 0;
    }

    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 15px;
    }

    .settings-title {
      font-size: 24px;
      font-weight: bold;
      color: white;
    }

    .btn-close-settings {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-close-settings:hover {
      transform: scale(1.2);
      color: #FF5722;
    }

    .settings-section {
      margin-bottom: 25px;
    }

    .settings-section-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #4FC3F7;
    }

    .input-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #fff;
      font-size: 16px;
    }

    input, button, textarea, select {
      font-size: 16px;
      padding: 12px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #fff;
      width: 100%;
      transition: all 0.3s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #4FC3F7;
      box-shadow: 0 0 15px rgba(79, 195, 247, 0.3);
      background: rgba(255, 255, 255, 0.1);
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    .file-input {
      position: relative;
      overflow: hidden;
      display: inline-block;
      width: 100%;
    }

    .file-input input[type=file] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .file-input label {
      display: inline-block;
      padding: 12px;
      background: linear-gradient(45deg, #4FC3F7, #00B0FF);
      color: white;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
      font-size: 16px;
      border: none;
      margin-bottom: 0;
    }

    .file-input:hover label {
      background: linear-gradient(45deg, #00B0FF, #0091EA);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 176, 255, 0.4);
    }

    .file-name {
      margin-top: 8px;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
    }

    .settings-actions {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }

    .btn-settings-action {
      flex: 1;
      padding: 12px;
      font-size: 16px;
    }

    .btn-reset {
      background: linear-gradient(45deg, #78909C, #607D8B);
    }

    .btn-reset:hover {
      background: linear-gradient(45deg, #607D8B, #455A64);
    }

    .btn-new-draw {
      background: linear-gradient(45deg, #9C27B0, #673AB7);
    }

    .btn-new-draw:hover {
      background: linear-gradient(45deg, #8E24AA, #5E35B1);
    }

    .winners-section {
      margin-top: 30px;
    }

    .winners-header {
      font-size: 28px;
      text-align: center;
      margin-bottom: 20px;
      background: linear-gradient(45deg, #FFC107, #FF5722);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: inline-block;
      margin-right: auto;
      margin-left: auto;
      position: relative;
      left: 50%;
      transform: translateX(-50%);
    }

    .winners-header:after {
      content: '';
      display: block;
      width: 60%;
      height: 3px;
      background: linear-gradient(to right, #FFC107, #FF5722);
      margin: 8px auto 0;
      border-radius: 3px;
    }

    .winners-list {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 20px;
      max-height: 250px;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2);
    }

    .winners-list::-webkit-scrollbar {
      width: 8px;
    }

    .winners-list::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .winners-list::-webkit-scrollbar-thumb {
      background: rgba(255, 193, 7, 0.3);
      border-radius: 4px;
    }

    .winners-list::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 193, 7, 0.5);
    }

    .winner-item {
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.06);
      border-left: 4px solid #FFC107;
      font-weight: 500;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .winner-item:hover {
      transform: translateX(-5px);
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .winner-item:last-child {
      margin-bottom: 0;
    }

    .winner-index {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #FFC107, #FF5722);
      color: #000;
      border-radius: 50%;
      text-align: center;
      margin-left: 15px;
      font-size: 18px;
      font-weight: bold;
      box-shadow: 0 3px 10px rgba(255, 87, 34, 0.3);
    }

    .winner-details {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .winner-name {
      font-weight: bold;
      font-size: 16px;
    }

    .winner-prize {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 5px;
    }

    .stats-section {
      padding: 20px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 15px;
      margin: 25px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid rgba(255, 255, 255, 0.08);
      position: relative;
      overflow: hidden;
    }

    .stats-section:before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, rgba(79, 195, 247, 0.05), rgba(224, 64, 251, 0.05));
      z-index: -1;
    }

    .stat-item {
      text-align: center;
      flex: 1;
      padding: 0 15px;
      position: relative;
    }

    .stat-item:not(:last-child):after {
      content: '';
      position: absolute;
      right: 0;
      top: 20%;
      height: 60%;
      width: 1px;
      background: rgba(255, 255, 255, 0.1);
    }

    .stat-value {
      font-size: 32px;
      font-weight: 700;
      background: linear-gradient(45deg, #4FC3F7, #00B0FF);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
    }

    .lottery-stage {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s;
      overflow: hidden;
    }

    .lottery-stage.active {
      opacity: 1;
      visibility: visible;
    }

    .stage-title {
      font-size: 36px;
      font-weight: bold;
      color: #fff;
      margin-bottom: 30px;
      text-align: center;
      text-shadow: 0 0 20px rgba(79, 195, 247, 0.8);
      animation: stageTitlePulse 2s infinite;
    }

    @keyframes stageTitlePulse {
      0% { text-shadow: 0 0 20px rgba(79, 195, 247, 0.8); }
      50% { text-shadow: 0 0 40px rgba(224, 64, 251, 0.8); }
      100% { text-shadow: 0 0 20px rgba(79, 195, 247, 0.8); }
    }

    .stage-cards-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 10px;
      padding: 20px;
      max-width: 90%;
      max-height: 60vh;
      overflow-y: auto;
      perspective: 1000px;
    }

    .stage-cards-container::-webkit-scrollbar {
      width: 8px;
    }

    .stage-cards-container::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .stage-cards-container::-webkit-scrollbar-thumb {
      background: rgba(79, 195, 247, 0.2);
      border-radius: 4px;
    }

    .stage-card {
      width: 90px;
      height: 104px;
      position: relative;
      margin: 5px;
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      background: rgba(255, 255, 255, 0.08);
      transition: all 0.5s;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      transform-style: preserve-3d;
    }

    .stage-card.highlight {
      animation: cardHighlight 0.5s;
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1) translateY(-5px);
      z-index: 10;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }

    .stage-card.selected {
      background: linear-gradient(135deg, #FFC107, #FF5722);
      transform: scale(1.2) translateY(-10px);
      box-shadow: 0 15px 30px rgba(255, 87, 34, 0.4);
      z-index: 20;
    }

    .stage-card.fade-out {
      opacity: 0.2;
      transform: scale(0.8);
    }

    @keyframes cardHighlight {
      0% { transform: scale(1); background: rgba(255, 255, 255, 0.08); }
      50% { transform: scale(1.2) translateY(-10px); background: rgba(255, 255, 255, 0.3); }
      100% { transform: scale(1.1) translateY(-5px); background: rgba(255, 255, 255, 0.2); }
    }

    .stage-card-index {
      position: absolute;
      top: 5px;
      left: 5px;
      font-size: 12px;
      font-weight: bold;
      color: rgba(255, 255, 255, 0.7);
    }

    .stage-card-name {
      font-size: 14px;
      text-align: center;
      word-break: break-word;
      max-height: 80%;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .stage-progress {
      width: 60%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin-top: 30px;
      overflow: hidden;
      position: relative;
    }

    .stage-progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(to right, #4FC3F7, #E040FB);
      border-radius: 4px;
      transition: width 0.3s;
    }

    .stage-controls {
      margin-top: 30px;
    }

    .btn-stage-settings {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 100;
    }

    .btn-stage-settings:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: rotate(30deg);
    }

    .btn-close-stage {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 16px;
      font-weight: bold;
    }

    .btn-close-stage:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #ffd700;
      top: 0;
      opacity: 0;
      z-index: 1000;
    }

    .stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .star {
      position: absolute;
      background-color: white;
      border-radius: 50%;
      opacity: 0.5;
      animation: twinkle 2s infinite;
    }

    @keyframes twinkle {
      0% { opacity: 0.2; }
      50% { opacity: 0.8; }
      100% { opacity: 0.2; }
    }

    .error-message {
      color: #FF5252;
      margin-top: 8px;
      font-size: 14px;
      text-shadow: 0 0 8px rgba(255, 82, 82, 0.5);
    }

    .sound-settings {
      display: flex;
      align-items: center;
      margin-top: 15px;
    }

    .sound-toggle {
      display: flex;
      align-items: center;
      margin-right: 20px;
    }

    .sound-label {
      margin-right: 10px;
      margin-bottom: 0;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.2);
      transition: .4s;
      border-radius: 24px;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.2);
      transition: .4s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .toggle-slider {
      background-color: #4FC3F7;
    }

    input:checked + .toggle-slider:before {
      transform: translateX(26px);
    }

    .draw-settings-row {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .draw-settings-col {
      flex: 1;
    }

    .no-items-message {
      text-align: center;
      font-size: 18px;
      color: rgba(255, 255, 255, 0.7);
      padding: 40px;
    }

    /* ◊ê◊§◊©◊®◊ï◊ô◊ï◊™ ◊ô◊ô◊¶◊ï◊ê */
    .export-section {
      margin-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      padding-top: 20px;
    }

    .export-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .export-title {
      font-size: 20px;
      font-weight: bold;
      color: #4FC3F7;
    }

    .export-actions {
      display: flex;
      gap: 10px;
    }

    .export-btn {
      background: linear-gradient(45deg, #00BFA5, #00796B);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      transition: all 0.3s;
    }

    .export-btn:hover {
      background: linear-gradient(45deg, #00897B, #00695C);
      transform: translateY(-2px);
      box-shadow: 0 5px 10px rgba(0, 191, 165, 0.3);
    }

    .copy-btn {
      background: linear-gradient(45deg, #7B1FA2, #6A1B9A);
    }

    .copy-btn:hover {
      background: linear-gradient(45deg, #6A1B9A, #4A148C);
    }

    .toast-message {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 16px;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }

    .toast-message.show {
      opacity: 1;
      visibility: visible;
    }

    /* ◊î◊í◊ì◊®◊™ ◊©◊ù ◊ú◊°◊ô◊ë◊ï◊ë */
    .draw-name-input {
      margin-bottom: 20px;
    }

    .draw-name-label {
      display: block;
      margin-bottom: 8px;
      color: #00B0FF;
      font-weight: bold;
    }

    .current-draw-name {
      font-size: 18px;
      font-weight: bold;
      color: #4FC3F7;
      margin-bottom: 15px;
      text-align: center;
    }

    /* ◊î◊í◊ì◊®◊ï◊™ ◊ê◊ï◊ì◊ô◊ï */
    .audio-settings-section {
      margin-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      padding-top: 20px;
    }

    .audio-select {
      margin-bottom: 10px;
    }

    .audio-upload {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed rgba(255, 255, 255, 0.2);
    }

    .audio-status {
      margin-top: 5px;
      font-size: 12px;
      color: #4FC3F7;
    }

    .audio-player {
      width: 100%;
      height: 30px;
      margin-top: 5px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    /* ◊®◊°◊§◊ï◊†◊°◊ô◊ë◊ô◊ï◊™ */
    @media (max-width: 992px) {
      .settings-panel {
        width: 320px;
        left: -320px;
      }

      .stage-cards-container {
        max-width: 95%;
      }

      .stage-progress {
        width: 90%;
      }
    }

    @media (max-width: 576px) {
      h1 {
        font-size: 28px;
      }

      .container {
        padding: 20px;
      }

      .btn-settings {
        top: 15px;
        left: 15px;
        width: 40px;
        height: 40px;
        font-size: 20px;
      }

      .stage-title {
        font-size: 24px;
        margin-bottom: 20px;
      }

      .stage-card {
        width: 70px;
        height: 80px;
      }

      .hexagon {
        width: 80px;
        height: 92px;
      }

      .export-actions {
        flex-direction: column;
      }

      .draw-settings-row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="stars-container" id="stars-container"></div>
  <div class="toast-message" id="toast-message"></div>

  <div class="container">
    <h1><span>◊û◊ó◊ï◊ú◊ú ◊î◊í◊®◊ú◊ï◊™</span> ◊§◊®◊ô◊û◊ô◊ï◊ù</h1>

    <button class="btn-settings" id="btn-settings">‚öôÔ∏è</button>

    <div class="main-content">
      <div class="current-draw-name" id="current-draw-name"></div>

      <div class="lottery-box">
        <div class="hexagon-container" id="hexagon-container">
          <div class="no-items-message" id="no-items-message">
            ◊ê◊ô◊ü ◊§◊®◊ô◊ò◊ô◊ù ◊ú◊î◊í◊®◊ú◊î, ◊ê◊†◊ê ◊î◊ï◊°◊£ ◊§◊®◊ô◊ò◊ô◊ù ◊ë◊î◊í◊ì◊®◊ï◊™
          </div>
        </div>
      </div>

      <div class="stats-section">
        <div class="stat-item">
          <div class="stat-value" id="total-items">0</div>
          <div class="stat-label">◊°◊ö ◊î◊õ◊ú ◊§◊®◊ô◊ò◊ô◊ù</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="available-items">0</div>
          <div class="stat-label">◊§◊®◊ô◊ò◊ô◊ù ◊ñ◊û◊ô◊†◊ô◊ù</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="total-winners">0</div>
          <div class="stat-label">◊°◊ö ◊î◊õ◊ú ◊ñ◊ï◊õ◊ô◊ù</div>
        </div>
      </div>

      <button class="btn-draw" id="btn-draw" disabled>
        <span class="btn-icon">üé≤</span>
        <span class="btn-text">◊î◊í◊®◊ú ◊¢◊õ◊©◊ô◊ï!</span>
      </button>

      <div class="winners-section">
        <h2 class="winners-header">◊î◊ñ◊ï◊õ◊ô◊ù ◊ë◊î◊í◊®◊ú◊î</h2>
        <div class="winners-list" id="winners-list"></div>

        <!-- ◊ê◊§◊©◊®◊ï◊ô◊ï◊™ ◊ô◊ô◊¶◊ï◊ê -->
        <div class="export-section" id="export-section" style="display: none;">
          <div class="export-header">
            <div class="export-title">◊ô◊ô◊¶◊ï◊ê ◊™◊ï◊¶◊ê◊ï◊™</div>
            <div class="export-actions">
              <button class="export-btn copy-btn" id="btn-copy-results">
                <span>◊î◊¢◊™◊ß ◊ú◊ú◊ï◊ó</span>
                <span>üìã</span>
              </button>
              <button class="export-btn" id="btn-export-csv">
                <span>◊ô◊ô◊¶◊ï◊ê ◊ú-CSV</span>
                <span>üìÑ</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="settings-panel" id="settings-panel">
    <div class="settings-header">
      <div class="settings-title">◊î◊í◊ì◊®◊ï◊™ ◊î◊î◊í◊®◊ú◊î</div>
      <button class="btn-close-settings" id="btn-close-settings">‚úï</button>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">◊î◊ï◊°◊§◊™ ◊§◊®◊ô◊ò◊ô◊ù</div>
      <div class="input-group">
        <label for="items-input">◊î◊ñ◊ü ◊§◊®◊ô◊ò◊ô◊ù (◊õ◊ú ◊©◊ï◊®◊î ◊§◊®◊ô◊ò ◊†◊§◊®◊ì):</label>
        <textarea id="items-input" placeholder="◊î◊ñ◊ü ◊§◊®◊ô◊ò◊ô◊ù ◊õ◊ê◊ü, ◊õ◊ú ◊§◊®◊ô◊ò ◊ë◊©◊ï◊®◊î ◊†◊§◊®◊ì◊™"></textarea>
      </div>

      <div class="input-group">
        <label>◊ê◊ï ◊ò◊¢◊ü ◊®◊©◊ô◊û◊î ◊û◊ß◊ï◊ë◊•:</label>
        <div class="file-input">
          <label for="file-upload">◊ë◊ó◊® ◊ß◊ï◊ë◊• ◊ò◊ß◊°◊ò</label>
          <input type="file" id="file-upload" accept=".txt,.csv">
        </div>
        <div class="file-name" id="file-name"></div>
      </div>

      <button id="btn-add-items">◊î◊ï◊°◊£ ◊§◊®◊ô◊ò◊ô◊ù</button>
      <div class="error-message" id="error-message"></div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">◊î◊í◊ì◊®◊ï◊™ ◊î◊í◊®◊ú◊î</div>

      <!-- ◊©◊ù ◊ú◊°◊ô◊ë◊ï◊ë ◊î◊î◊í◊®◊ú◊î ◊î◊†◊ï◊õ◊ó◊ô -->
      <div class="input-group draw-name-input">
        <label for="draw-name">◊©◊ù ◊ú◊°◊ô◊ë◊ï◊ë ◊î◊î◊í◊®◊ú◊î ◊î◊†◊ï◊õ◊ó◊ô:</label>
        <input type="text" id="draw-name" placeholder="◊ú◊ì◊ï◊í◊û◊î: ◊§◊®◊° ◊®◊ê◊©◊ï◊ü, ◊ó◊ï◊ú◊¶◊ï◊™, ◊ê◊®◊ï◊ó◊™ ◊ë◊ï◊ß◊®...">
      </div>

      <div class="draw-settings-row">
        <div class="draw-settings-col">
          <div class="input-group">
            <label for="winners-count">◊û◊°◊§◊® ◊ñ◊ï◊õ◊ô◊ù ◊ú◊î◊í◊®◊ú◊î:</label>
            <input type="number" id="winners-count" min="1" value="1">
          </div>
        </div>
        <div class="draw-settings-col">
          <div class="input-group">
            <label for="allow-duplicates">◊ê◊§◊©◊® ◊õ◊§◊ô◊ú◊ï◊ô◊ï◊™:</label>
            <select id="allow-duplicates">
              <option value="true">◊õ◊ü - ◊ê◊§◊©◊® ◊©◊û◊ï◊™ ◊ñ◊î◊ô◊ù</option>
              <option value="false">◊ú◊ê - ◊û◊†◊¢ ◊õ◊§◊ô◊ú◊ï◊ô◊ï◊™</option>
            </select>
          </div>
        </div>
      </div>

      <div class="sound-settings">
        <div class="sound-toggle">
          <label class="sound-label">◊ê◊§◊ß◊ò◊ô ◊¶◊ú◊ô◊ú:</label>
          <label class="toggle-switch">
            <input type="checkbox" id="sound-toggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="sound-toggle">
          <label class="sound-label">◊ê◊†◊ô◊û◊¶◊ô◊ï◊™:</label>
          <label class="toggle-switch">
            <input type="checkbox" id="animation-toggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- ◊î◊í◊ì◊®◊ï◊™ ◊ê◊ï◊ì◊ô◊ï -->
    <div class="settings-section audio-settings-section">
      <div class="settings-section-title">◊î◊í◊ì◊®◊ï◊™ ◊¶◊ú◊ô◊ú◊ô◊ù</div>

      <!-- ◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù -->
      <div class="input-group">
        <label for="drumroll-sound">◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù ◊ú◊î◊í◊®◊ú◊î:</label>
        <select id="drumroll-sound" class="audio-select">
          <option value="default">◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú</option>
          <option value="custom">◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™</option>
        </select>

        <div id="custom-drumroll-container" class="audio-upload" style="display: none;">
          <div class="file-input">
            <label for="custom-drumroll-file">◊î◊¢◊ú◊î ◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™</label>
            <input type="file" id="custom-drumroll-file" accept="audio/*">
          </div>
          <div class="audio-status" id="drumroll-status"></div>
          <audio controls id="drumroll-preview" class="audio-player" style="display: none;"></audio>
        </div>
      </div>

      <!-- ◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î -->
      <div class="input-group">
        <label for="tada-sound">◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î:</label>
        <select id="tada-sound" class="audio-select">
          <option value="default">◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú</option>
          <option value="custom">◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™</option>
        </select>

        <div id="custom-tada-container" class="audio-upload" style="display: none;">
          <div class="file-input">
            <label for="custom-tada-file">◊î◊¢◊ú◊î ◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™</label>
            <input type="file" id="custom-tada-file" accept="audio/*">
          </div>
          <div class="audio-status" id="tada-status"></div>
          <audio controls id="tada-preview" class="audio-player" style="display: none;"></audio>
        </div>
      </div>

      <!-- ◊¶◊ú◊ô◊ú ◊ò◊ô◊ß -->
      <div class="input-group">
        <label for="tick-sound">◊¶◊ú◊ô◊ú ◊ú◊ó◊ô◊¶◊î:</label>
        <select id="tick-sound" class="audio-select">
          <option value="default">◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú</option>
          <option value="custom">◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™</option>
        </select>

        <div id="custom-tick-container" class="audio-upload" style="display: none;">
          <div class="file-input">
            <label for="custom-tick-file">◊î◊¢◊ú◊î ◊¶◊ú◊ô◊ú ◊ú◊ó◊ô◊¶◊î ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™</label>
            <input type="file" id="custom-tick-file" accept="audio/*">
          </div>
          <div class="audio-status" id="tick-status"></div>
          <audio controls id="tick-preview" class="audio-player" style="display: none;"></audio>
        </div>
      </div>
    </div>

    <div class="settings-actions">
      <button class="btn-settings-action btn-reset" id="btn-reset">◊ê◊§◊° ◊ñ◊ï◊õ◊ô◊ù</button>
      <button class="btn-settings-action btn-new-draw" id="btn-new-draw">◊î◊í◊®◊ú◊î ◊ó◊ì◊©◊î</button>
    </div>
  </div>

  <div class="lottery-stage" id="lottery-stage">
    <div class="stage-title">◊î◊î◊í◊®◊ú◊î ◊û◊™◊ë◊¶◊¢◊™...</div>
    <div class="stage-cards-container" id="stage-cards-container"></div>
    <div class="stage-progress">
      <div class="stage-progress-bar" id="stage-progress-bar"></div>
    </div>
    <div class="stage-controls">
      <button class="btn-close-stage" id="btn-close-stage" style="display: none;">◊ó◊ñ◊ï◊® ◊ú◊û◊°◊ö ◊î◊®◊ê◊©◊ô</button>
    </div>
    <button class="btn-stage-settings" id="btn-stage-settings">‚öôÔ∏è</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // ◊ô◊¶◊ô◊®◊™ ◊õ◊ï◊õ◊ë◊ô◊ù ◊ë◊®◊ß◊¢
      createStars();

      // ◊ê◊ú◊û◊†◊ò◊ô◊ù
      const settingsPanel = document.getElementById('settings-panel');
      const btnSettings = document.getElementById('btn-settings');
      const btnCloseSettings = document.getElementById('btn-close-settings');
      const btnStageSettings = document.getElementById('btn-stage-settings');
      const itemsInput = document.getElementById('items-input');
      const fileUpload = document.getElementById('file-upload');
      const fileName = document.getElementById('file-name');
      const btnAddItems = document.getElementById('btn-add-items');
      const hexagonContainer = document.getElementById('hexagon-container');
      const noItemsMessage = document.getElementById('no-items-message');
      const winnersCountInput = document.getElementById('winners-count');
      const allowDuplicatesSelect = document.getElementById('allow-duplicates');
      const soundToggle = document.getElementById('sound-toggle');
      const animationToggle = document.getElementById('animation-toggle');
      const btnDraw = document.getElementById('btn-draw');
      const btnReset = document.getElementById('btn-reset');
      const btnNewDraw = document.getElementById('btn-new-draw');
      const winnersList = document.getElementById('winners-list');
      const totalItemsEl = document.getElementById('total-items');
      const availableItemsEl = document.getElementById('available-items');
      const totalWinnersEl = document.getElementById('total-winners');
      const errorMessage = document.getElementById('error-message');
      const lotteryStage = document.getElementById('lottery-stage');
      const stageCardsContainer = document.getElementById('stage-cards-container');
      const stageProgressBar = document.getElementById('stage-progress-bar');
      const btnCloseStage = document.getElementById('btn-close-stage');
      const exportSection = document.getElementById('export-section');
      const btnCopyResults = document.getElementById('btn-copy-results');
      const btnExportCsv = document.getElementById('btn-export-csv');
      const toastMessage = document.getElementById('toast-message');
      const drawNameInput = document.getElementById('draw-name');
      const currentDrawName = document.getElementById('current-draw-name');

      // ◊ê◊ú◊û◊†◊ò◊ô ◊ê◊ï◊ì◊ô◊ï
      const drumrollSoundSelect = document.getElementById('drumroll-sound');
      const tadaSoundSelect = document.getElementById('tada-sound');
      const tickSoundSelect = document.getElementById('tick-sound');
      const customDrumrollContainer = document.getElementById('custom-drumroll-container');
      const customTadaContainer = document.getElementById('custom-tada-container');
      const customTickContainer = document.getElementById('custom-tick-container');
      const customDrumrollFile = document.getElementById('custom-drumroll-file');
      const customTadaFile = document.getElementById('custom-tada-file');
      const customTickFile = document.getElementById('custom-tick-file');
      const drumrollStatus = document.getElementById('drumroll-status');
      const tadaStatus = document.getElementById('tada-status');
      const tickStatus = document.getElementById('tick-status');
      const drumrollPreview = document.getElementById('drumroll-preview');
      const tadaPreview = document.getElementById('tada-preview');
      const tickPreview = document.getElementById('tick-preview');

      // ◊ê◊ï◊ì◊ô◊ï ◊ß◊ï◊†◊ò◊ß◊°◊ò
      let audioContext;

      // ◊¶◊ú◊ô◊ú◊ô◊ù
      let drumrollSound;
      let tadaSound;
      let tickSound;

      // ◊û◊¶◊ë ◊î◊¶◊ú◊ô◊ú◊ô◊ù
      let customAudioSettings = {
        drumroll: {
          type: 'default',
          buffer: null,
          url: null
        },
        tada: {
          type: 'default',
          buffer: null,
          url: null
        },
        tick: {
          type: 'default',
          buffer: null,
          url: null
        }
      };

      // ◊û◊¶◊ë ◊î◊û◊¢◊®◊õ◊™
      let allItems = []; // ◊õ◊ú ◊î◊§◊®◊ô◊ò◊ô◊ù
      let uniqueItems = []; // ◊§◊®◊ô◊ò◊ô◊ù ◊ô◊ô◊ó◊ï◊ì◊ô◊ô◊ù ◊ë◊ú◊ë◊ì
      let availableItems = []; // ◊§◊®◊ô◊ò◊ô◊ù ◊ñ◊û◊ô◊†◊ô◊ù ◊ú◊î◊í◊®◊ú◊î
      let winningItems = []; // ◊§◊®◊ô◊ò◊ô◊ù ◊©◊ñ◊õ◊ï ◊¢◊ù ◊û◊ñ◊î◊î ◊ô◊ô◊ó◊ï◊ì◊ô
      let currentDrawPrize = ''; // ◊©◊ù ◊ú◊°◊ô◊ë◊ï◊ë ◊î◊î◊í◊®◊ú◊î ◊î◊†◊ï◊õ◊ó◊ô
      let drawRounds = []; // ◊®◊©◊ô◊û◊™ ◊õ◊ú ◊°◊ô◊ë◊ï◊ë◊ô ◊î◊î◊í◊®◊ú◊î (◊û◊õ◊ô◊ú ◊©◊ù ◊ú◊õ◊ú ◊°◊ô◊ë◊ï◊ë)
      let isDrawing = false; // ◊î◊ê◊ù ◊†◊û◊¶◊ê◊ô◊ù ◊ë◊™◊î◊ú◊ô◊ö ◊î◊í◊®◊ú◊î
      let isSoundOn = true; // ◊î◊ê◊ù ◊¶◊ú◊ô◊ú◊ô◊ù ◊û◊ï◊§◊¢◊ú◊ô◊ù
      let isAnimationsOn = true; // ◊î◊ê◊ù ◊ê◊†◊ô◊û◊¶◊ô◊ï◊™ ◊û◊ï◊§◊¢◊ú◊ï◊™

      // ◊¢◊ì◊õ◊ï◊ü ◊ú◊§◊ô ◊û◊¶◊ë ◊î◊î◊í◊ì◊®◊ï◊™
      isSoundOn = soundToggle.checked;
      isAnimationsOn = animationToggle.checked;

      // ◊î◊ê◊ñ◊†◊î ◊ú◊ê◊ô◊®◊ï◊¢◊ô◊ù
      btnSettings.addEventListener('click', toggleSettings);
      btnCloseSettings.addEventListener('click', toggleSettings);
      btnStageSettings.addEventListener('click', toggleSettings);
      btnAddItems.addEventListener('click', addItems);
      fileUpload.addEventListener('change', handleFileUpload);
      btnDraw.addEventListener('click', startDraw);
      btnReset.addEventListener('click', resetWinners);
      btnNewDraw.addEventListener('click', newDraw);
      btnCloseStage.addEventListener('click', closeLotteryStage);
      btnCopyResults.addEventListener('click', copyResultsToClipboard);
      btnExportCsv.addEventListener('click', exportResultsToCsv);
      drawNameInput.addEventListener('input', updateDrawName);
      soundToggle.addEventListener('change', () => {
        isSoundOn = soundToggle.checked;
        initAudio();
      });
      animationToggle.addEventListener('change', () => {
        isAnimationsOn = animationToggle.checked;
      });

      // ◊ê◊ô◊®◊ï◊¢◊ô◊ù ◊ú◊î◊í◊ì◊®◊ï◊™ ◊ê◊ï◊ì◊ô◊ï
      drumrollSoundSelect.addEventListener('change', () => toggleCustomAudio('drumroll'));
      tadaSoundSelect.addEventListener('change', () => toggleCustomAudio('tada'));
      tickSoundSelect.addEventListener('change', () => toggleCustomAudio('tick'));

      customDrumrollFile.addEventListener('change', (e) => handleCustomAudioUpload(e, 'drumroll'));
      customTadaFile.addEventListener('change', (e) => handleCustomAudioUpload(e, 'tada'));
      customTickFile.addEventListener('change', (e) => handleCustomAudioUpload(e, 'tick'));

      // ◊ò◊¢◊ô◊†◊™ ◊î◊í◊ì◊®◊ï◊™ ◊û◊ß◊ï◊û◊ô◊ï◊™
      loadLocalSettings();

      // ◊§◊ï◊†◊ß◊¶◊ô◊î ◊ú◊î◊§◊¢◊ú◊™ ◊ê◊ï◊ì◊ô◊ï
      function initAudio() {
        if (isSoundOn && !audioContext) {
          try {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            // ◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú◊ô◊ù
            loadSounds();
          } catch (e) {
            console.error('◊ú◊ê ◊†◊ô◊™◊ü ◊ú◊î◊§◊¢◊ô◊ú ◊ê◊ï◊ì◊ô◊ï:', e);
          }
        }
      }

      // ◊ô◊¶◊ô◊®◊™ ◊õ◊ï◊õ◊ë◊ô◊ù
      function createStars() {
        const starsContainer = document.getElementById('stars-container');
        const starsCount = 100;

        for (let i = 0; i < starsCount; i++) {
          const star = document.createElement('div');
          star.className = 'star';
          star.style.left = `${Math.random() * 100}%`;
          star.style.top = `${Math.random() * 100}%`;
          star.style.width = `${Math.random() * 3 + 1}px`;
          star.style.height = star.style.width;
          star.style.animationDelay = `${Math.random() * 2}s`;

          starsContainer.appendChild(star);
        }
      }

      // ◊¢◊ì◊õ◊ï◊ü ◊©◊ù ◊î◊î◊í◊®◊ú◊î ◊î◊†◊ï◊õ◊ó◊ô◊™
      function updateDrawName() {
        currentDrawPrize = drawNameInput.value.trim();

        if (currentDrawPrize) {
          currentDrawName.textContent = `◊î◊í◊®◊ú◊™ ${currentDrawPrize}`;
          currentDrawName.style.display = 'block';
        } else {
          currentDrawName.textContent = '';
          currentDrawName.style.display = 'none';
        }
      }

      // ◊ò◊¢◊ô◊†◊™ ◊î◊í◊ì◊®◊ï◊™ ◊û◊ß◊ï◊û◊ô◊ï◊™
      function loadLocalSettings() {
        try {
          // ◊ò◊¢◊ô◊†◊™ ◊î◊í◊ì◊®◊ï◊™ ◊ê◊ï◊ì◊ô◊ï
          const savedAudioSettings = localStorage.getItem('customAudioSettings');
          if (savedAudioSettings) {
            const parsedSettings = JSON.parse(savedAudioSettings);

            // ◊¢◊ì◊õ◊ï◊ü ◊°◊ï◊í ◊î◊¶◊ú◊ô◊ú
            if (parsedSettings.drumroll && parsedSettings.drumroll.type) {
              drumrollSoundSelect.value = parsedSettings.drumroll.type;
              toggleCustomAudio('drumroll');

              if (parsedSettings.drumroll.url) {
                drumrollStatus.textContent = "◊¶◊ú◊ô◊ú ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™ ◊†◊ò◊¢◊ü";
                drumrollPreview.src = parsedSettings.drumroll.url;
                drumrollPreview.style.display = 'block';
              }
            }

            if (parsedSettings.tada && parsedSettings.tada.type) {
              tadaSoundSelect.value = parsedSettings.tada.type;
              toggleCustomAudio('tada');

              if (parsedSettings.tada.url) {
                tadaStatus.textContent = "◊¶◊ú◊ô◊ú ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™ ◊†◊ò◊¢◊ü";
                tadaPreview.src = parsedSettings.tada.url;
                tadaPreview.style.display = 'block';
              }
            }

            if (parsedSettings.tick && parsedSettings.tick.type) {
              tickSoundSelect.value = parsedSettings.tick.type;
              toggleCustomAudio('tick');

              if (parsedSettings.tick.url) {
                tickStatus.textContent = "◊¶◊ú◊ô◊ú ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™ ◊†◊ò◊¢◊ü";
                tickPreview.src = parsedSettings.tick.url;
                tickPreview.style.display = 'block';
              }
            }

            // ◊¢◊ì◊õ◊ï◊ü ◊û◊¶◊ë ◊î◊¶◊ú◊ô◊ú◊ô◊ù
            customAudioSettings = parsedSettings;
          }
        } catch (error) {
          console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊î◊í◊ì◊®◊ï◊™ ◊û◊ß◊ï◊û◊ô◊ï◊™:', error);
        }
      }

      // ◊©◊û◊ô◊®◊™ ◊î◊í◊ì◊®◊ï◊™ ◊û◊ß◊ï◊û◊ô◊ï◊™
      function saveLocalSettings() {
        try {
          localStorage.setItem('customAudioSettings', JSON.stringify(customAudioSettings));
        } catch (error) {
          console.error('◊©◊í◊ô◊ê◊î ◊ë◊©◊û◊ô◊®◊™ ◊î◊í◊ì◊®◊ï◊™ ◊û◊ß◊ï◊û◊ô◊ï◊™:', error);
        }
      }

      // ◊î◊ï◊ó◊ú◊§◊î ◊ë◊ó◊ô◊®◊™ ◊°◊ï◊í ◊î◊¶◊ú◊ô◊ú
      function toggleCustomAudio(soundType) {
        const select = document.getElementById(`${soundType}-sound`);
        const container = document.getElementById(`custom-${soundType}-container`);

        if (select.value === 'custom') {
          container.style.display = 'block';
          customAudioSettings[soundType].type = 'custom';
        } else {
          container.style.display = 'none';
          customAudioSettings[soundType].type = 'default';
        }

        saveLocalSettings();

        // ◊ò◊¢◊ô◊†◊™ ◊î◊¶◊ú◊ô◊ú◊ô◊ù ◊û◊ó◊ì◊© ◊ê◊ù ◊ô◊© ◊¶◊ï◊®◊ö
        if (audioContext) {
          loadSounds();
        }
      }

      // ◊ò◊ô◊§◊ï◊ú ◊ë◊î◊¢◊ú◊ê◊™ ◊ß◊ï◊ë◊• ◊ê◊ï◊ì◊ô◊ï ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™
      function handleCustomAudioUpload(event, soundType) {
        const file = event.target.files[0];
        if (!file) return;

        const statusElement = document.getElementById(`${soundType}-status`);
        const previewElement = document.getElementById(`${soundType}-preview`);

        statusElement.textContent = "◊û◊¢◊ú◊î...";

        try {
          // ◊ô◊¶◊ô◊®◊™ URL ◊ú◊ß◊ï◊ë◊•
          const audioUrl = URL.createObjectURL(file);

          // ◊¢◊ì◊õ◊ï◊ü ◊™◊¶◊ï◊í◊™ ◊ß◊ì◊ù
          previewElement.src = audioUrl;
          previewElement.style.display = 'block';

          // ◊¢◊ì◊õ◊ï◊ü ◊û◊¶◊ë ◊î◊¶◊ú◊ô◊ú
          customAudioSettings[soundType].url = audioUrl;
          customAudioSettings[soundType].filename = file.name;

          // ◊†◊ô◊°◊ô◊ï◊ü ◊ú◊ò◊¢◊ï◊ü ◊ê◊™ ◊î◊ß◊ï◊ë◊• ◊ú◊ê◊ï◊ì◊ô◊ï ◊ß◊ï◊†◊ò◊ß◊°◊ò
          if (audioContext) {
            file.arrayBuffer().then(arrayBuffer => {
              return audioContext.decodeAudioData(arrayBuffer);
            }).then(audioBuffer => {
              customAudioSettings[soundType].buffer = audioBuffer;
              statusElement.textContent = `◊î◊ß◊ï◊ë◊• ${file.name} ◊†◊ò◊¢◊ü ◊ë◊î◊¶◊ú◊ó◊î`;
              saveLocalSettings();
            }).catch(error => {
              statusElement.textContent = `◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊î◊ß◊ï◊ë◊•: ${error.message}`;
              console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊ß◊ï◊ë◊• ◊ê◊ï◊ì◊ô◊ï:', error);
            });
          } else {
            statusElement.textContent = `◊î◊ß◊ï◊ë◊• ${file.name} ◊û◊ï◊õ◊ü`;
            saveLocalSettings();
          }
        } catch (error) {
          statusElement.textContent = `◊©◊í◊ô◊ê◊î: ${error.message}`;
          console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊ô◊§◊ï◊ú ◊ë◊ß◊ï◊ë◊• ◊ê◊ï◊ì◊ô◊ï:', error);
        }
      }

      // ◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú◊ô◊ù
          async function loadSounds() {
            if (!audioContext) return;

            try {
              // ◊†◊™◊ô◊ë◊ô◊ù ◊ú◊ß◊ë◊¶◊ô ◊ê◊ï◊ì◊ô◊ï ◊û◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú
              const defaultSoundPaths = {
                drumroll: 'audio/drumroll.mp3',
                tada: 'audio/tada.mp3',
                tick: 'audio/tick.mp3'
              };

              // ◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú◊ô ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú ◊ê◊ï ◊¶◊ú◊ô◊ú◊ô◊ù ◊û◊ï◊™◊ê◊û◊ô◊ù ◊ê◊ô◊©◊ô◊™
              // ◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù
              if (customAudioSettings.drumroll.type === 'custom' && customAudioSettings.drumroll.buffer) {
                // ◊ê◊ù ◊õ◊ë◊® ◊ô◊© ◊ë◊ê◊§◊® ◊û◊ï◊õ◊ü
                drumrollSound = customAudioSettings.drumroll.buffer;
              } else if (customAudioSettings.drumroll.type === 'custom' && customAudioSettings.drumroll.url) {
                // ◊ê◊ù ◊ô◊© URL ◊ú◊¶◊ú◊ô◊ú ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™
                try {
                  const response = await fetch(customAudioSettings.drumroll.url);
                  const arrayBuffer = await response.arrayBuffer();
                  drumrollSound = await audioContext.decodeAudioData(arrayBuffer);
                  customAudioSettings.drumroll.buffer = drumrollSound;
                } catch (error) {
                  console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™:', error);
                  drumrollSound = createDummySound(0.2, 'sawtooth');
                }
              } else {
                // ◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú
                try {
                  const response = await fetch(defaultSoundPaths.drumroll);
                  const arrayBuffer = await response.arrayBuffer();
                  drumrollSound = await audioContext.decodeAudioData(arrayBuffer);
                } catch (error) {
                  console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú:', error);
                  drumrollSound = createDummySound(0.2, 'sawtooth');
                }
              }

              // ◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î
              if (customAudioSettings.tada.type === 'custom' && customAudioSettings.tada.buffer) {
                tadaSound = customAudioSettings.tada.buffer;
              } else if (customAudioSettings.tada.type === 'custom' && customAudioSettings.tada.url) {
                try {
                  const response = await fetch(customAudioSettings.tada.url);
                  const arrayBuffer = await response.arrayBuffer();
                  tadaSound = await audioContext.decodeAudioData(arrayBuffer);
                  customAudioSettings.tada.buffer = tadaSound;
                } catch (error) {
                  console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™:', error);
                  tadaSound = createDummySound(0.8, 'triangle');
                }
              } else {
                try {
                  const response = await fetch(defaultSoundPaths.tada);
                  const arrayBuffer = await response.arrayBuffer();
                  tadaSound = await audioContext.decodeAudioData(arrayBuffer);
                } catch (error) {
                  console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú:', error);
                  tadaSound = createDummySound(0.8, 'triangle');
                }
              }

              // ◊¶◊ú◊ô◊ú ◊ò◊ô◊ß
              if (customAudioSettings.tick.type === 'custom' && customAudioSettings.tick.buffer) {
                tickSound = customAudioSettings.tick.buffer;
              } else if (customAudioSettings.tick.type === 'custom' && customAudioSettings.tick.url) {
                try {
                  const response = await fetch(customAudioSettings.tick.url);
                  const arrayBuffer = await response.arrayBuffer();
                  tickSound = await audioContext.decodeAudioData(arrayBuffer);
                  customAudioSettings.tick.buffer = tickSound;
                } catch (error) {
                  console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊ò◊ô◊ß ◊û◊ï◊™◊ê◊ù ◊ê◊ô◊©◊ô◊™:', error);
                  tickSound = createDummySound(0.5, 'sine');
                }
              } else {
                try {
                  const response = await fetch(defaultSoundPaths.tick);
                  const arrayBuffer = await response.arrayBuffer();
                  tickSound = await audioContext.decodeAudioData(arrayBuffer);
                } catch (error) {
                  console.error('◊©◊í◊ô◊ê◊î ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú ◊ò◊ô◊ß ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú:', error);
                  tickSound = createDummySound(0.5, 'sine');
                }
              }
            } catch (error) {
              console.error('◊©◊í◊ô◊ê◊î ◊õ◊ú◊ú◊ô◊™ ◊ë◊ò◊¢◊ô◊†◊™ ◊¶◊ú◊ô◊ú◊ô◊ù:', error);

              // ◊ô◊¶◊ô◊®◊™ ◊¶◊ú◊ô◊ú◊ô◊ù ◊û◊ì◊ï◊û◊ô◊ù ◊ë◊û◊ß◊®◊î ◊©◊ú ◊©◊í◊ô◊ê◊î
              drumrollSound = createDummySound(0.2, 'sawtooth');
              tadaSound = createDummySound(0.8, 'triangle');
              tickSound = createDummySound(0.5, 'sine');
            }
          }

          // ◊ô◊¶◊ô◊®◊™ ◊¶◊ú◊ô◊ú ◊ú◊ì◊ï◊í◊û◊î (◊ú◊ú◊ê ◊ò◊¢◊ô◊†◊™ ◊ß◊ï◊ë◊• ◊ë◊§◊ï◊¢◊ú)
          function createDummySound(freq, type) {
            return {
              type: type,
              frequency: freq
            };
          }

          // ◊†◊ô◊í◊ï◊ü ◊¶◊ú◊ô◊ú
          function playSound(sound, options = {}) {
            if (!isSoundOn || !audioContext) return null;

            try {
              // ◊ê◊ù ◊î◊ê◊ï◊ì◊ô◊ï ◊ß◊ï◊†◊ò◊ß◊°◊ò ◊û◊ï◊©◊î◊î, ◊î◊§◊¢◊ú ◊ê◊ï◊™◊ï
              if (audioContext.state === 'suspended') {
                audioContext.resume();
              }

              // ◊ë◊ì◊ô◊ß◊î ◊ê◊ù ◊û◊ì◊ï◊ë◊® ◊ë◊ê◊ï◊ì◊ô◊ï ◊ë◊ê◊§◊® ◊ê◊û◊ô◊™◊ô ◊ê◊ï ◊¶◊ú◊ô◊ú ◊û◊ì◊ï◊û◊î
              if (sound.type && sound.frequency) {
                // ◊¶◊ú◊ô◊ú ◊û◊ì◊ï◊û◊î
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.type = sound.type || 'sine';
                oscillator.frequency.value = sound.frequency * 300 + 200;

                gainNode.gain.value = options.volume || 0.3;

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.start();

                if (!options.loop) {
                  setTimeout(() => {
                    oscillator.stop();
                  }, options.duration || 300);
                }

                return oscillator;
              } else {
                // ◊ñ◊î◊ï ◊ê◊ï◊ì◊ô◊ï ◊ë◊ê◊§◊® ◊ê◊û◊ô◊™◊ô
                const source = audioContext.createBufferSource();
                source.buffer = sound;

                const gainNode = audioContext.createGain();
                gainNode.gain.value = options.volume || 0.5;

                source.connect(gainNode);
                gainNode.connect(audioContext.destination);

                if (options.loop) {
                  source.loop = true;
                }

                source.start();

                if (!options.loop && options.duration) {
                  setTimeout(() => {
                    source.stop();
                  }, options.duration);
                }

                return source;
              }
            } catch (error) {
              console.error('◊©◊í◊ô◊ê◊î ◊ë◊†◊ô◊í◊ï◊ü ◊¶◊ú◊ô◊ú:', error);
              return null;
            }
          }

          // ◊¢◊¶◊ô◊®◊™ ◊¶◊ú◊ô◊ú
          function stopSound(source) {
            if (!source) return;

            try {
              source.stop();
            } catch (error) {
              console.error('◊©◊í◊ô◊ê◊î ◊ë◊¢◊¶◊ô◊®◊™ ◊¶◊ú◊ô◊ú:', error);
            }
          }

          // ◊§◊™◊ô◊ó◊î/◊°◊í◊ô◊®◊î ◊©◊ú ◊§◊ê◊†◊ú ◊î◊î◊í◊ì◊®◊ï◊™
          function toggleSettings() {
            settingsPanel.classList.toggle('open');

            // ◊ê◊™◊ó◊ï◊ú ◊ê◊ï◊ì◊ô◊ï ◊ë◊ú◊ó◊ô◊¶◊î ◊¢◊ú ◊õ◊§◊™◊ï◊® ◊î◊î◊í◊ì◊®◊ï◊™
            if (settingsPanel.classList.contains('open')) {
              initAudio();
            }
          }

          // ◊î◊ï◊°◊§◊™ ◊§◊®◊ô◊ò◊ô◊ù
          function addItems() {
            const newItemsText = itemsInput.value.trim();
            if (!newItemsText) {
              showError('◊†◊ê ◊ú◊î◊ñ◊ô◊ü ◊§◊®◊ô◊ò◊ô◊ù ◊ú◊§◊†◊ô ◊î◊î◊ï◊°◊§◊î');
              return;
            }

            const newItems = newItemsText.split('\n')
              .map(item => item.trim())
              .filter(item => item);

            if (newItems.length === 0) {
              showError('◊ú◊ê ◊†◊û◊¶◊ê◊ï ◊§◊®◊ô◊ò◊ô◊ù ◊™◊ß◊ô◊†◊ô◊ù');
              return;
            }

            const allowDuplicates = allowDuplicatesSelect.value === 'true';

            // ◊®◊©◊ô◊û◊™ ◊§◊®◊ô◊ò◊ô◊ù ◊ó◊ì◊©◊ô◊ù ◊û◊°◊ï◊û◊†◊ô◊ù ◊¢◊ù ◊û◊ñ◊î◊î ◊ô◊ô◊ó◊ï◊ì◊ô
            let nextId = allItems.length;
            const newItemsWithIds = newItems.map(item => {
              return {
                name: item,
                id: nextId++
              };
            });

            // ◊î◊ï◊°◊§◊™ ◊î◊§◊®◊ô◊ò◊ô◊ù ◊ú◊®◊©◊ô◊û◊™ ◊î◊§◊®◊ô◊ò◊ô◊ù
            if (allowDuplicates) {
              // ◊ë◊û◊ß◊®◊î ◊©◊û◊ê◊§◊©◊®◊ô◊ù ◊õ◊§◊ô◊ú◊ï◊ô◊ï◊™
              allItems = [...allItems, ...newItemsWithIds];
              availableItems = [...availableItems, ...newItemsWithIds];

              // ◊¢◊ì◊õ◊ï◊ü ◊®◊©◊ô◊û◊™ ◊î◊§◊®◊ô◊ò◊ô◊ù ◊î◊ô◊ô◊ó◊ï◊ì◊ô◊ô◊ù
              newItems.forEach(item => {
                if (!uniqueItems.includes(item)) {
                  uniqueItems.push(item);
                }
              });
            } else {
              // ◊û◊†◊ô◊¢◊™ ◊õ◊§◊ô◊ú◊ï◊ô◊ï◊™ - ◊®◊ß ◊©◊û◊ï◊™ ◊ô◊ô◊ó◊ï◊ì◊ô◊ô◊ù
              for (const newItem of newItemsWithIds) {
                if (!uniqueItems.includes(newItem.name)) {
                  allItems.push(newItem);
                  availableItems.push(newItem);
                  uniqueItems.push(newItem.name);
                }
              }
            }

            // ◊¢◊ì◊õ◊ï◊ü ◊™◊¶◊ï◊í◊™ ◊î◊§◊®◊ô◊ò◊ô◊ù
            renderItems();
            updateStats();
            updateDrawButton();
            itemsInput.value = '';
            errorMessage.textContent = '';

            // ◊ê◊ù ◊ñ◊ê◊™ ◊î◊§◊¢◊ù ◊î◊®◊ê◊©◊ï◊†◊î ◊©◊û◊ï◊°◊ô◊§◊ô◊ù ◊§◊®◊ô◊ò◊ô◊ù, ◊î◊°◊™◊® ◊ê◊™ ◊î◊ï◊ì◊¢◊™ ◊î"◊ê◊ô◊ü ◊§◊®◊ô◊ò◊ô◊ù"
            if (allItems.length > 0) {
              noItemsMessage.style.display = 'none';
            }

            // ◊î◊©◊û◊¢◊™ ◊¶◊ú◊ô◊ú ◊ê◊ô◊©◊ï◊®
            playSound(tickSound, { volume: 0.3 });
          }

          // ◊ò◊ô◊§◊ï◊ú ◊ë◊î◊¢◊ú◊ê◊™ ◊ß◊ï◊ë◊•
          function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            fileName.textContent = file.name;

            const reader = new FileReader();
            reader.onload = function(e) {
              const content = e.target.result;
              itemsInput.value = content;
            };
            reader.readAsText(file);
          }

          // ◊î◊¶◊í◊™ ◊§◊®◊ô◊ò◊ô◊ù ◊ë◊û◊°◊ö
          function renderItems() {
            hexagonContainer.innerHTML = '';

            // ◊ô◊¶◊ô◊®◊™ ◊ê◊ú◊û◊†◊ò◊ô◊ù ◊¢◊ë◊ï◊® ◊õ◊ú ◊î◊§◊®◊ô◊ò◊ô◊ù
            allItems.forEach(item => {
              const hexagon = document.createElement('div');
              hexagon.className = 'hexagon';
              hexagon.dataset.id = item.id;
              hexagon.dataset.name = item.name;

              // ◊ë◊ì◊ô◊ß◊î ◊ê◊ù ◊î◊§◊®◊ô◊ò ◊ñ◊õ◊î ◊õ◊ë◊®
              const isWinner = winningItems.some(winItem => winItem.id === item.id);
              if (isWinner) {
                hexagon.classList.add('winner');
              }

              // ◊ô◊¶◊ô◊®◊™ ◊™◊ï◊õ◊ü ◊î◊§◊®◊ô◊ò
              const hexIndex = document.createElement('div');
              hexIndex.className = 'hexagon-index';
              hexIndex.textContent = item.id + 1; // ◊û◊°◊§◊ï◊® ◊î◊ó◊ú ◊û-1

              const hexContent = document.createElement('div');
              hexContent.className = 'hexagon-content';
              hexContent.textContent = item.name;

              hexagon.appendChild(hexIndex);
              hexagon.appendChild(hexContent);

              hexagonContainer.appendChild(hexagon);
            });
          }

          // ◊¢◊ì◊õ◊ï◊ü ◊°◊ò◊ò◊ô◊°◊ò◊ô◊ß◊ï◊™
          function updateStats() {
            totalItemsEl.textContent = allItems.length;
            availableItemsEl.textContent = availableItems.length;
            totalWinnersEl.textContent = winningItems.length;

            // ◊î◊¶◊í/◊î◊°◊™◊® ◊ê◊ñ◊ï◊® ◊î◊ô◊ô◊¶◊ï◊ê ◊ë◊î◊™◊ê◊ù ◊ú◊û◊°◊§◊® ◊î◊ñ◊ï◊õ◊ô◊ù
            if (winningItems.length > 0) {
              exportSection.style.display = 'block';
            } else {
              exportSection.style.display = 'none';
            }
          }

          // ◊¢◊ì◊õ◊ï◊ü ◊õ◊§◊™◊ï◊® ◊î◊î◊í◊®◊ú◊î
          function updateDrawButton() {
            // ◊ó◊©◊ï◊ë! - ◊õ◊ê◊ü ◊û◊ï◊ï◊ì◊ê◊ô◊ù ◊©◊î◊õ◊§◊™◊ï◊® ◊§◊¢◊ô◊ú ◊ê◊ù ◊ô◊© ◊§◊®◊ô◊ò◊ô◊ù ◊ñ◊û◊ô◊†◊ô◊ù
            btnDraw.disabled = (availableItems.length === 0 || isDrawing);

            if (availableItems.length === 0) {
              btnDraw.innerHTML = '<span class="btn-icon">üé≤</span><span class="btn-text">◊ê◊ô◊ü ◊§◊®◊ô◊ò◊ô◊ù ◊ñ◊û◊ô◊†◊ô◊ù</span>';
            } else {
              btnDraw.innerHTML = '<span class="btn-icon">üé≤</span><span class="btn-text">◊î◊í◊®◊ú ◊¢◊õ◊©◊ô◊ï!</span>';
            }
          }

          // ◊î◊¶◊í◊™ ◊î◊ï◊ì◊¢◊™ ◊©◊í◊ô◊ê◊î
          function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.opacity = '0';

            // ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊î◊ï◊§◊¢◊î
            setTimeout(() => {
              errorMessage.style.transition = 'opacity 0.3s';
              errorMessage.style.opacity = '1';
            }, 10);
          }

          // ◊î◊¶◊í◊™ ◊î◊ï◊ì◊¢◊™ ◊ò◊ï◊°◊ò
          function showToast(message, duration = 3000) {
            toastMessage.textContent = message;
            toastMessage.classList.add('show');

            setTimeout(() => {
              toastMessage.classList.remove('show');
            }, duration);
          }

          // ◊î◊™◊ó◊ú◊™ ◊î◊í◊®◊ú◊î - ◊î◊§◊ï◊†◊ß◊¶◊ô◊î ◊î◊ó◊ì◊©◊î ◊¢◊ù ◊ê◊§◊ß◊ò ◊î◊ó◊ú◊§◊™ ◊û◊ì◊í◊û◊ô◊ù
          function startDraw() {
            let winnersCount = parseInt(winnersCountInput.value);
            if (winnersCount <= 0) {
              showError('◊û◊°◊§◊® ◊î◊ñ◊ï◊õ◊ô◊ù ◊ó◊ô◊ô◊ë ◊ú◊î◊ô◊ï◊™ ◊ó◊ô◊ï◊ë◊ô');
              return;
            }

            // ◊û◊°◊§◊® ◊î◊ñ◊ï◊õ◊ô◊ù ◊ú◊ê ◊ô◊õ◊ï◊ú ◊ú◊î◊ô◊ï◊™ ◊í◊ì◊ï◊ú ◊û◊û◊°◊§◊® ◊î◊§◊®◊ô◊ò◊ô◊ù ◊î◊ñ◊û◊ô◊†◊ô◊ù
            if (winnersCount > availableItems.length) {
              winnersCount = availableItems.length;
              showError(`◊û◊°◊§◊® ◊î◊ñ◊ï◊õ◊ô◊ù ◊î◊ï◊™◊ê◊ù ◊ú-${winnersCount} (◊û◊°◊§◊® ◊î◊§◊®◊ô◊ò◊ô◊ù ◊î◊ñ◊û◊ô◊†◊ô◊ù)`);
            }

            isDrawing = true;
            updateDrawButton();

            // ◊©◊û◊ô◊®◊™ ◊©◊ù ◊°◊ô◊ë◊ï◊ë ◊î◊î◊í◊®◊ú◊î ◊î◊†◊ï◊õ◊ó◊ô
            const drawRoundPrize = currentDrawPrize || '';

            // ◊ê◊™◊ó◊ï◊ú ◊û◊°◊ö ◊î◊î◊í◊®◊ú◊î
            stageCardsContainer.innerHTML = '';
            stageProgressBar.style.width = '0%';
            btnCloseStage.style.display = 'none';

            // ◊î◊¶◊í◊™ ◊û◊°◊ö ◊î◊î◊í◊®◊ú◊î
            lotteryStage.classList.add('active');

            // ◊ë◊ó◊ô◊®◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊û◊®◊ê◊© (◊ê◊ö ◊ú◊ê ◊û◊¶◊ô◊í◊ô◊ù ◊ê◊ï◊™◊ù ◊¢◊ì◊ô◊ô◊ü)
            const newWinningItems = [];
            const tempAvailableItems = [...availableItems];

            for (let i = 0; i < winnersCount; i++) {
              if (tempAvailableItems.length === 0) break;

              const randomIndex = Math.floor(Math.random() * tempAvailableItems.length);
              const winner = tempAvailableItems[randomIndex];

              // ◊î◊ï◊°◊§◊™ ◊©◊ù ◊î◊§◊®◊° ◊ú◊ñ◊ï◊õ◊î
              const winnerWithPrize = {
                ...winner,
                prize: drawRoundPrize,
                drawRound: drawRounds.length // ◊û◊°◊§◊® ◊°◊ô◊ë◊ï◊ë
              };

              newWinningItems.push(winnerWithPrize);
              tempAvailableItems.splice(randomIndex, 1);
            }

            // ◊©◊û◊ô◊®◊™ ◊°◊ô◊ë◊ï◊ë ◊î◊î◊í◊®◊ú◊î
            drawRounds.push({
              name: drawRoundPrize,
              winners: newWinningItems.map(w => w.id)
            });

            // ◊î◊í◊ì◊®◊ï◊™ ◊ê◊†◊ô◊û◊¶◊ô◊î
            const totalPhases = isAnimationsOn ? 30 : 15; // ◊°◊ö ◊õ◊ú ◊©◊ú◊ë◊ô ◊î◊ê◊†◊ô◊û◊¶◊ô◊î
            const initialSampleSize = Math.min(60, Math.max(20, availableItems.length / 2)); // ◊õ◊û◊î ◊§◊®◊ô◊ò◊ô◊ù ◊ú◊î◊¶◊ô◊í ◊ë◊õ◊ú ◊§◊¢◊ù
            let currentPhase = 0;

            // ◊î◊§◊¢◊ú◊™ ◊¶◊ú◊ô◊ú ◊™◊ï◊§◊ô◊ù
            const drumrollInstance = playSound(drumrollSound, { loop: true, volume: 0.5, duration: 5000 });

            // ◊§◊ï◊†◊ß◊¶◊ô◊î ◊ú◊î◊¶◊í◊™ ◊û◊ì◊í◊ù ◊ê◊ß◊®◊ê◊ô ◊©◊ú ◊§◊®◊ô◊ò◊ô◊ù
            function showRandomSample() {
              stageCardsContainer.innerHTML = ''; // ◊†◊ô◊ß◊ï◊ô ◊î◊™◊¶◊ï◊í◊î ◊î◊ß◊ï◊ì◊û◊™

              // ◊ó◊ô◊©◊ï◊ë ◊í◊ï◊ì◊ú ◊î◊û◊ì◊í◊ù ◊ú◊©◊ú◊ë ◊î◊†◊ï◊õ◊ó◊ô
              // ◊õ◊õ◊ú ◊©◊û◊™◊ß◊ì◊û◊ô◊ù ◊ë◊©◊ú◊ë◊ô◊ù, ◊î◊û◊ì◊í◊ù ◊û◊™◊õ◊†◊° ◊ô◊ï◊™◊® ◊ú◊ß◊ë◊ï◊¶◊™ ◊î◊ñ◊ï◊õ◊ô◊ù
              const progress = currentPhase / totalPhases;
              let sampleSize = Math.max(
                winnersCount,
                Math.floor(initialSampleSize - progress * (initialSampleSize - winnersCount))
              );

              // ◊ë◊ó◊ô◊®◊™ ◊î◊û◊ì◊í◊ù - ◊©◊ô◊ú◊ï◊ë ◊©◊ú ◊§◊®◊ô◊ò◊ô◊ù ◊ê◊ß◊®◊ê◊ô◊ô◊ù + ◊î◊ñ◊ï◊õ◊ô◊ù ◊î◊¢◊™◊ô◊ì◊ô◊ô◊ù
              let sample = [];

              // ◊î◊ï◊°◊§◊™ ◊ó◊ú◊ß ◊û◊î◊ñ◊ï◊õ◊ô◊ù ◊ë◊î◊ì◊®◊í◊î
              const winnersToInclude = Math.ceil(newWinningItems.length * Math.min(1, progress * 1.5));
              for (let i = 0; i < winnersToInclude; i++) {
                sample.push(newWinningItems[i]);
              }

              // ◊î◊ï◊°◊§◊™ ◊§◊®◊ô◊ò◊ô◊ù ◊ê◊ß◊®◊ê◊ô◊ô◊ù ◊ú◊î◊©◊ú◊û◊™ ◊î◊û◊ì◊í◊ù
              const otherItems = availableItems.filter(item =>
                !sample.some(sampleItem => sampleItem.id === item.id)
              );

              // ◊¢◊®◊ë◊ï◊ë ◊î◊§◊®◊ô◊ò◊ô◊ù ◊î◊ê◊ó◊®◊ô◊ù
              const shuffledOtherItems = [...otherItems].sort(() => Math.random() - 0.5);

              // ◊î◊ï◊°◊§◊™ ◊§◊®◊ô◊ò◊ô◊ù ◊ê◊ß◊®◊ê◊ô◊ô◊ù ◊¢◊ì ◊ú◊û◊ô◊ú◊ï◊ô ◊î◊û◊ì◊í◊ù
              while (sample.length < sampleSize && shuffledOtherItems.length > 0) {
                sample.push(shuffledOtherItems.pop());
              }

              // ◊¢◊®◊ë◊ï◊ë ◊î◊û◊ì◊í◊ù
              sample = sample.sort(() => Math.random() - 0.5);

              // ◊î◊¶◊í◊™ ◊î◊û◊ì◊í◊ù
              sample.forEach(item => {
                const card = document.createElement('div');
                card.className = 'stage-card';
                card.dataset.id = item.id;
                card.dataset.name = item.name;

                // ◊î◊ì◊í◊©◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊ë◊©◊ú◊ë◊ô◊ù ◊î◊ê◊ó◊®◊ï◊†◊ô◊ù
                if (progress > 0.8 && newWinningItems.some(w => w.id === item.id)) {
                  card.classList.add('highlight');
                }

                // ◊î◊ï◊°◊§◊™ ◊û◊°◊§◊® ◊û◊ñ◊î◊î ◊ï◊©◊ù
                const cardIndex = document.createElement('div');
                cardIndex.className = 'stage-card-index';
                cardIndex.textContent = item.id + 1;

                const cardName = document.createElement('div');
                cardName.className = 'stage-card-name';
                cardName.textContent = item.name;

                card.appendChild(cardIndex);
                card.appendChild(cardName);

                stageCardsContainer.appendChild(card);
              });

              // ◊¢◊ì◊õ◊ï◊ü ◊§◊° ◊î◊î◊™◊ß◊ì◊û◊ï◊™
              currentPhase++;
              stageProgressBar.style.width = `${(currentPhase / totalPhases) * 100}%`;

              // ◊î◊©◊û◊¢◊™ ◊¶◊ú◊ô◊ú ◊ò◊ô◊ß
              if (currentPhase % 3 === 0) {
                playSound(tickSound, { volume: 0.1, duration: 100 });
              }

              // ◊°◊ô◊ï◊ù ◊î◊ê◊†◊ô◊û◊¶◊ô◊î ◊ê◊ï ◊î◊û◊©◊ö
              if (currentPhase >= totalPhases) {
                clearInterval(sampleInterval);
                finishDraw(newWinningItems, drumrollInstance);
              }
            }

            // ◊î◊™◊ó◊ú◊™ ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊î◊ó◊ú◊§◊™ ◊î◊û◊ì◊í◊û◊ô◊ù
            const interval = isAnimationsOn ? 200 : 100;
            const sampleInterval = setInterval(showRandomSample, interval);
          }

          // ◊°◊ô◊ï◊ù ◊î◊î◊í◊®◊ú◊î
          function finishDraw(newWinningItems, drumrollInstance) {
            // ◊¢◊¶◊ô◊®◊™ ◊¶◊ú◊ô◊ú ◊î◊™◊ï◊§◊ô◊ù
            stopSound(drumrollInstance);

            // ◊†◊ô◊ß◊ï◊ô ◊î◊û◊°◊ö ◊ï◊î◊¶◊í◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊ë◊ú◊ë◊ì
            stageCardsContainer.innerHTML = '';

            newWinningItems.forEach(winner => {
              const card = document.createElement('div');
              card.className = 'stage-card selected';
              card.dataset.id = winner.id;
              card.dataset.name = winner.name;

              const cardIndex = document.createElement('div');
              cardIndex.className = 'stage-card-index';
              cardIndex.textContent = winner.id + 1;

              const cardName = document.createElement('div');
              cardName.className = 'stage-card-name';
              cardName.textContent = winner.name;

              card.appendChild(cardIndex);
              card.appendChild(cardName);

              stageCardsContainer.appendChild(card);
            });

            // ◊î◊°◊®◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊û◊®◊©◊ô◊û◊™ ◊î◊§◊®◊ô◊ò◊ô◊ù ◊î◊ñ◊û◊ô◊†◊ô◊ù
            newWinningItems.forEach(winItem => {
              const index = availableItems.findIndex(item => item.id === winItem.id);
              if (index !== -1) {
                availableItems.splice(index, 1);
              }
            });

            // ◊î◊ï◊°◊§◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊ú◊®◊©◊ô◊û◊™ ◊î◊ñ◊ï◊õ◊ô◊ù
            winningItems = [...winningItems, ...newWinningItems];

            // ◊î◊©◊û◊¢◊™ ◊¶◊ú◊ô◊ú ◊ñ◊õ◊ô◊ô◊î
            playSound(tadaSound, { volume: 0.7, duration: 1500 });

            // ◊¢◊ì◊õ◊ï◊ü ◊õ◊ï◊™◊®◊™
            document.querySelector('.stage-title').textContent = '◊î◊ñ◊ï◊õ◊ô◊ù ◊ë◊î◊í◊®◊ú◊î!';

            // ◊î◊¶◊í◊™ ◊õ◊§◊™◊ï◊® ◊ó◊ñ◊®◊î
            setTimeout(() => {
              btnCloseStage.style.display = 'block';

              // ◊¢◊ì◊õ◊ï◊ü ◊î◊û◊û◊©◊ß ◊î◊®◊ê◊©◊ô
              renderItems();
              updateWinnersList(newWinningItems);
              updateStats();

              isDrawing = false;
              updateDrawButton();

              // ◊ô◊¶◊ô◊®◊™ ◊ê◊§◊ß◊ò ◊ß◊ï◊†◊§◊ò◊ô ◊¢◊ë◊ï◊® ◊õ◊ú ◊ñ◊ï◊õ◊î
              if (isAnimationsOn) {
                const winnerCards = stageCardsContainer.querySelectorAll('.stage-card.selected');
                winnerCards.forEach(card => {
                  createConfetti(card);
                });
              }
            }, 1500);
          }

          // ◊¢◊ì◊õ◊ï◊ü ◊®◊©◊ô◊û◊™ ◊î◊ñ◊ï◊õ◊ô◊ù - ◊¢◊ù ◊™◊û◊ô◊õ◊î ◊ë◊©◊ù ◊î◊§◊®◊°
          function updateWinnersList(newWinningItems) {
            newWinningItems.forEach(winner => {
              // ◊ó◊ô◊©◊ï◊ë ◊î◊û◊ô◊ß◊ï◊ù ◊©◊ú ◊î◊ñ◊ï◊õ◊î ◊î◊†◊ï◊õ◊ó◊ô (◊ú◊ê ◊ú◊§◊ô ◊©◊ù ◊ê◊ú◊ê ◊ú◊§◊ô ◊û◊ô◊ß◊ï◊ù ◊ë◊®◊©◊ô◊û◊™ ◊î◊ñ◊ï◊õ◊ô◊ù)
              const winnerIndex = winningItems.findIndex(item => item.id === winner.id) + 1;

              const winnerItem = document.createElement('div');
              winnerItem.className = 'winner-item';
              winnerItem.dataset.id = winner.id;

              const winnerIndexEl = document.createElement('span');
              winnerIndexEl.className = 'winner-index';
              winnerIndexEl.textContent = winnerIndex;

              const winnerDetails = document.createElement('div');
              winnerDetails.className = 'winner-details';

              const winnerName = document.createElement('div');
              winnerName.className = 'winner-name';
              winnerName.textContent = winner.name;

              winnerDetails.appendChild(winnerName);

              // ◊î◊ï◊°◊§◊™ ◊©◊ù ◊î◊§◊®◊° ◊ê◊ù ◊ß◊ô◊ô◊ù
              if (winner.prize) {
                const winnerPrize = document.createElement('div');
                winnerPrize.className = 'winner-prize';
                winnerPrize.textContent = `◊ñ◊õ◊î ◊ë: ${winner.prize}`;
                winnerDetails.appendChild(winnerPrize);
              }

              winnerItem.appendChild(winnerIndexEl);
              winnerItem.appendChild(winnerDetails);

              // ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊î◊ï◊§◊¢◊î
              winnerItem.style.opacity = '0';
              winnerItem.style.transform = 'translateY(20px)';

              winnersList.appendChild(winnerItem);

              // ◊î◊§◊¢◊ú◊™ ◊ê◊†◊ô◊û◊¶◊ô◊î
              setTimeout(() => {
                winnerItem.style.transition = 'all 0.5s ease-out';
                winnerItem.style.opacity = '1';
                winnerItem.style.transform = 'translateY(0)';
              }, 100);

              // ◊ô◊¶◊ô◊®◊™ ◊ß◊ï◊†◊§◊ò◊ô ◊¢◊ú ◊î◊ñ◊ï◊õ◊î ◊ë◊û◊°◊ö ◊î◊®◊ê◊©◊ô
              if (isAnimationsOn) {
                setTimeout(() => {
                  const hexagons = document.querySelectorAll(`.hexagon[data-id="${winner.id}"]`);
                  hexagons.forEach(hexagon => {
                    createConfetti(hexagon);
                  });
                }, 500);
              }
            });
          }

          // ◊î◊¢◊™◊ß◊™ ◊™◊ï◊¶◊ê◊ï◊™ ◊ú◊ú◊ï◊ó
          function copyResultsToClipboard() {
            if (winningItems.length === 0) return;

            let textToCopy = "◊™◊ï◊¶◊ê◊ï◊™ ◊î◊î◊í◊®◊ú◊î:\n\n";

            // ◊ß◊ô◊ë◊ï◊• ◊î◊ñ◊ï◊õ◊ô◊ù ◊ú◊§◊ô ◊°◊ô◊ë◊ï◊ë◊ô◊ù
            const roundsMap = {};

            // ◊û◊ô◊ï◊ü ◊î◊ñ◊ï◊õ◊ô◊ù ◊ú◊§◊ô ◊°◊ô◊ë◊ï◊ë◊ô◊ù
            winningItems.forEach((winner, index) => {
              const roundName = winner.prize || '◊ú◊ú◊ê ◊©◊ù';

              if (!roundsMap[roundName]) {
                roundsMap[roundName] = [];
              }

              roundsMap[roundName].push({
                index: index + 1,
                name: winner.name
              });
            });

            // ◊î◊ï◊°◊§◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊û◊°◊ï◊ì◊®◊ô◊ù ◊ú◊§◊ô ◊°◊ô◊ë◊ï◊ë◊ô◊ù
            for (const roundName in roundsMap) {
              textToCopy += `== ${roundName} ==\n`;

              roundsMap[roundName].forEach(winner => {
                textToCopy += `${winner.index}. ${winner.name}\n`;
              });

              textToCopy += '\n';
            }

            // ◊î◊¢◊™◊ß◊î ◊ú◊ú◊ï◊ó
            navigator.clipboard.writeText(textToCopy)
              .then(() => {
                showToast("◊î◊™◊ï◊¶◊ê◊ï◊™ ◊î◊ï◊¢◊™◊ß◊ï ◊ë◊î◊¶◊ú◊ó◊î ◊ú◊ú◊ï◊ó!");
                playSound(tickSound, { volume: 0.5 });
              })
              .catch(err => {
                console.error('◊©◊í◊ô◊ê◊î ◊ë◊î◊¢◊™◊ß◊î ◊ú◊ú◊ï◊ó:', err);
                showToast("◊ê◊ô◊®◊¢◊î ◊©◊í◊ô◊ê◊î ◊ë◊î◊¢◊™◊ß◊î ◊ú◊ú◊ï◊ó");
              });
          }

          // ◊ô◊ô◊¶◊ï◊ê ◊™◊ï◊¶◊ê◊ï◊™ ◊ú◊ß◊ï◊ë◊• CSV
          function exportResultsToCsv() {
            if (winningItems.length === 0) return;

            // ◊ô◊¶◊ô◊®◊™ ◊™◊ï◊õ◊ü ◊î-CSV ◊¢◊ù BOM ◊ú◊™◊û◊ô◊õ◊î ◊ë◊¢◊ë◊®◊ô◊™
            let csvContent = "\uFEFF" + "◊û◊°◊§◊®,◊©◊ù ◊ñ◊ï◊õ◊î,◊§◊®◊°\n";

            // ◊î◊ï◊°◊§◊™ ◊õ◊ú ◊î◊ñ◊ï◊õ◊ô◊ù
            winningItems.forEach((winner, index) => {
              const prize = winner.prize || '';
              csvContent += `${index + 1},"${winner.name}","${prize}"\n`;
            });

            // ◊ô◊¶◊ô◊®◊™ ◊î◊ß◊ï◊ë◊•
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);

            // ◊ô◊¶◊ô◊®◊™ ◊ß◊ô◊©◊ï◊® ◊ú◊î◊ï◊®◊ì◊î
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", "◊™◊ï◊¶◊ê◊ï◊™_◊î◊í◊®◊ú◊î.csv");
            document.body.appendChild(link);

            // ◊î◊ï◊®◊ì◊™ ◊î◊ß◊ï◊ë◊• ◊ï◊î◊°◊®◊™ ◊î◊ß◊ô◊©◊ï◊®
            link.click();
            document.body.removeChild(link);

            showToast("◊î◊ß◊ï◊ë◊• ◊î◊ï◊®◊ì ◊ë◊î◊¶◊ú◊ó◊î!");
            playSound(tickSound, { volume: 0.5 });
          }

          // ◊ô◊¶◊ô◊®◊™ ◊ê◊§◊ß◊ò ◊ß◊ï◊†◊§◊ò◊ô
          function createConfetti(element) {
            if (!isAnimationsOn) return;

            const rect = element.getBoundingClientRect();
            const container = document.querySelector('.container');
            const containerRect = container.getBoundingClientRect();

            for (let i = 0; i < 30; i++) {
              const confetti = document.createElement('div');
              confetti.className = 'confetti';

              // ◊¶◊ë◊¢◊ô◊ù ◊©◊ï◊†◊ô◊ù ◊ú◊ß◊ï◊†◊§◊ò◊ô
              const colors = ['#FF5722', '#FFC107', '#4FC3F7', '#E040FB', '#76FF03', '#FFEB3B'];
              const randomColor = colors[Math.floor(Math.random() * colors.length)];

              // ◊¶◊ï◊®◊ï◊™ ◊©◊ï◊†◊ï◊™
            const shapes = ['50%', '0%'];
            const randomShape = shapes[Math.floor(Math.random() * shapes.length)];

            // ◊í◊ì◊ú◊ô◊ù ◊©◊ï◊†◊ô◊ù
            const size = Math.random() * 10 + 5;

            confetti.style.backgroundColor = randomColor;
            confetti.style.borderRadius = randomShape;
            confetti.style.width = `${size}px`;
            confetti.style.height = `${size}px`;
            confetti.style.left = `${rect.left - containerRect.left + rect.width / 2}px`;
            confetti.style.top = `${rect.top - containerRect.top + rect.height / 2}px`;

            container.appendChild(confetti);

            // ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊†◊§◊ô◊ú◊î
            const angle = Math.random() * Math.PI * 2;
            const distance = Math.random() * 100 + 50;
            const duration = 1000 + Math.random() * 1000;

            const destX = distance * Math.cos(angle);
            const destY = distance * Math.sin(angle);

            confetti.animate([
              { transform: 'translate(0, 0) rotate(0deg) scale(0)', opacity: 1 },
              { transform: `translate(${destX}px, ${destY}px) rotate(${Math.random() * 720 - 360}deg) scale(1)`, opacity: 1, offset: 0.7 },
              { transform: `translate(${destX}px, ${destY * 1.5}px) rotate(${Math.random() * 720 - 360}deg) scale(0.5)`, opacity: 0 }
            ], {
              duration: duration,
              easing: 'cubic-bezier(0.1, 0.8, 0.3, 1)',
              fill: 'forwards'
            });

            // ◊û◊ó◊ô◊ß◊™ ◊î◊ß◊ï◊†◊§◊ò◊ô ◊ê◊ó◊®◊ô ◊°◊ô◊ï◊ù ◊î◊ê◊†◊ô◊û◊¶◊ô◊î
            setTimeout(() => {
              confetti.remove();
            }, duration + 100);
          }
        }

        // ◊ê◊ô◊§◊ï◊° ◊ñ◊ï◊õ◊ô◊ù
        function resetWinners() {
          // ◊î◊ó◊ñ◊®◊™ ◊î◊ñ◊ï◊õ◊ô◊ù ◊ú◊§◊®◊ô◊ò◊ô◊ù ◊î◊ñ◊û◊ô◊†◊ô◊ù
          availableItems = [...allItems];
          winningItems = [];
          drawRounds = [];

          // ◊†◊ô◊ß◊ï◊ô ◊°◊ô◊û◊ï◊†◊ô ◊ñ◊ï◊õ◊ô◊ù
          const hexagons = document.querySelectorAll('.hexagon');
          hexagons.forEach(hex => hex.classList.remove('winner'));

          // ◊†◊ô◊ß◊ï◊ô ◊®◊©◊ô◊û◊™ ◊î◊ñ◊ï◊õ◊ô◊ù
          winnersList.innerHTML = '';

          // ◊¢◊ì◊õ◊ï◊ü ◊î◊û◊û◊©◊ß
          updateStats();
          updateDrawButton();

          // ◊î◊©◊û◊¢◊™ ◊¶◊ú◊ô◊ú ◊ê◊ô◊§◊ï◊°
          playSound(tickSound, { volume: 0.5 });
        }

        // ◊î◊í◊®◊ú◊î ◊ó◊ì◊©◊î
        function newDraw() {
          // ◊ê◊ô◊§◊ï◊° ◊õ◊ú ◊î◊û◊¢◊®◊õ◊™
          resetWinners();
          allItems = [];
          availableItems = [];
          uniqueItems = [];
          currentDrawPrize = '';
          drawNameInput.value = '';
          currentDrawName.textContent = '';
          currentDrawName.style.display = 'none';
          hexagonContainer.innerHTML = '';
          noItemsMessage.style.display = 'block';

          // ◊¢◊ì◊õ◊ï◊ü ◊î◊û◊û◊©◊ß
          updateStats();
          updateDrawButton();

          // ◊î◊©◊û◊¢◊™ ◊¶◊ú◊ô◊ú ◊ê◊ô◊§◊ï◊°
          playSound(tickSound, { volume: 0.5 });
        }

        // ◊°◊í◊ô◊®◊™ ◊û◊°◊ö ◊î◊î◊í◊®◊ú◊î
        function closeLotteryStage() {
          lotteryStage.classList.remove('active');
        }

        // ◊ê◊™◊ó◊ï◊ú ◊î◊ì◊£
        updateStats();
        updateDrawButton();

        // ◊ô◊¶◊ô◊®◊™ ◊†◊™◊ï◊†◊ô ◊ì◊ï◊í◊û◊î - ◊ê◊§◊©◊® ◊ú◊ë◊ò◊ú ◊ë◊í◊®◊°◊î ◊î◊°◊ï◊§◊ô◊™
        function createSampleData() {
          itemsInput.value =
            "◊û◊©◊™◊™◊£ 1\n" +
            "◊û◊©◊™◊™◊£ 2\n" +
            "◊û◊©◊™◊™◊£ 3\n" +
            "◊û◊©◊™◊™◊£ 4\n" +
            "◊û◊©◊™◊™◊£ 5\n" +
            "◊û◊©◊™◊™◊£ 6\n" +
            "◊û◊©◊™◊™◊£ 7\n" +
            "◊û◊©◊™◊™◊£ 8\n" +
            "◊û◊©◊™◊™◊£ 9\n" +
            "◊û◊©◊™◊™◊£ 10\n" +
            "◊û◊©◊™◊™◊£ 1";  // ◊õ◊§◊ô◊ú◊ï◊™ ◊ú◊ì◊ï◊í◊û◊î

          drawNameInput.value = "◊§◊®◊° ◊®◊ê◊©◊ï◊ü";
          updateDrawName();
        }

        // ◊ú◊ó◊ô◊¶◊î ◊õ◊§◊ï◊ú◊î ◊¢◊ú ◊ê◊ñ◊ï◊® ◊î◊ò◊ß◊°◊ò ◊ú◊î◊ñ◊†◊™ ◊ì◊ï◊í◊û◊ê◊ï◊™
        itemsInput.addEventListener('dblclick', function() {
          if (itemsInput.value.trim() === '') {
            createSampleData();
          }
        });
      });
    </script>
  </body>
  </html>
